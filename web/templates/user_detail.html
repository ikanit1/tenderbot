{% extends "base.html" %}
{% block title %}–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {{ user.id }} ‚Äî TenderBot Admin{% endblock %}
{% block header_title %}–ö–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è{% endblock %}
{% block content %}
<div class="page-header">
    <h2 class="page-title">{{ user.full_name }}</h2>
    <p class="page-subtitle">ID {{ user.id }} ¬∑ Telegram ID {{ user.tg_id }}</p>
</div>
<div class="detail-actions">
    <a href="/users/{{ user.id }}/edit" class="btn btn-warning">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
    <a href="/users" class="btn btn-secondary">‚Üê –ö —Å–ø–∏—Å–∫—É</a>
</div>
<div class="detail-info">
    <p><strong>ID:</strong> {{ user.id }}</p>
    <p><strong>Telegram ID:</strong> {{ user.tg_id }}</p>
    <p><strong>–†–æ–ª—å:</strong> <span class="badge badge-neutral">{{ user.role|translate_role }}</span></p>
    <p><strong>–°—Ç–∞—Ç—É—Å:</strong>
        <span class="badge {% if user.status == 'active' %}badge-success{% elif user.status == 'pending_moderation' %}badge-warning{% else %}badge-danger{% endif %}">{{ user.status|translate_status }}</span>
    </p>
    <p><strong>–ì–æ—Ä–æ–¥:</strong> {{ user.city }}</p>
    <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> {{ user.phone }}</p>
    {% if user.birth_date %}
    <p><strong>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</strong> {{ user.birth_date.strftime('%d.%m.%Y') }}</p>
    {% endif %}
    <p><strong>–ù–∞–≤—ã–∫–∏:</strong> {{ user.skills|join(", ") if user.skills else "‚Äî" }}</p>
    {% if user.created_at %}
    <p><strong>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</strong> {{ user.created_at.strftime('%d.%m.%Y %H:%M') }}</p>
    {% endif %}
</div>

{% if documents_list %}
<div class="card moderation-block">
    <h3>üìé –ê—Ä—Ö–∏–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
    <p class="form-hint">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ Telegram ID). –†–∞–∑—Ä–µ—à–µ–Ω—ã: —Ñ–æ—Ç–æ (JPEG, PNG), PDF. –ü–æ—Å–ª–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å.</p>
    <ul class="doc-list">
        {% for doc in documents_list %}
        <li>
            {% if doc.type == "photo" %}
            <a href="/users/by-tg/{{ user.tg_id }}/document?index={{ loop.index0 }}" target="_blank" rel="noopener">üñºÔ∏è –§–æ—Ç–æ {{ loop.index }}</a>
            {% else %}
            <a href="/users/by-tg/{{ user.tg_id }}/document?index={{ loop.index0 }}" target="_blank" rel="noopener">üìÑ –î–æ–∫—É–º–µ–Ω—Ç {{ loop.index }}</a>
            {% if doc.file_name %}<span class="form-hint"> ‚Äî {{ doc.file_name }}</span>{% endif %}
            {% endif %}
        </li>
        {% endfor %}
    </ul>
    <form method="post" action="/users/{{ user.id }}/documents/delete" style="margin-top: 0.75rem;" onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã —É —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è? –°—Å—ã–ª–∫–∏ –Ω–∞ —Ñ–∞–π–ª—ã –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.');">
        <button type="submit" class="btn btn-danger">üóë –£–¥–∞–ª–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã</button>
    </form>
</div>
{% endif %}

<div class="card">
    <h3 class="card-title">–î–µ–π—Å—Ç–≤–∏—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏</h3>
    <div class="btn-group">
        {% if user.status == "pending_moderation" %}
        <form method="post" action="/users/{{ user.id }}/approve" style="display: inline-block;">
            <button type="submit" class="btn btn-success">‚úÖ –û–¥–æ–±—Ä–∏—Ç—å</button>
        </form>
        <form method="post" action="/users/{{ user.id }}/reject" style="display: inline-block;">
            <button type="submit" class="btn btn-danger">‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
        </form>
        {% elif user.status == "banned" %}
        <form method="post" action="/users/{{ user.id }}/unban" style="display: inline-block;">
            <button type="submit" class="btn btn-success">üîì –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å</button>
        </form>
        {% elif user.status == "active" %}
        <form method="post" action="/users/{{ user.id }}/ban" style="display: inline-block;">
            <button type="submit" class="btn btn-danger">üö´ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å</button>
        </form>
        {% endif %}
        <form method="post" action="/users/{{ user.id }}/delete" style="display: inline-block;" onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ? –û—Ç–∫–ª–∏–∫–∏, —Ç–∏–∫–µ—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ –æ—Ç–∑—ã–≤—ã –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.');">
            <button type="submit" class="btn btn-secondary">üóë –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
        </form>
    </div>
</div>
{% endblock %}
